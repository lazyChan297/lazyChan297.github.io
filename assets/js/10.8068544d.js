(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{365:function(t,s,a){"use strict";a.r(s);var n=a(45),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"白屏现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#白屏现象"}},[t._v("#")]),t._v(" 白屏现象")]),t._v(" "),a("p",[t._v("分为白屏异常和白屏时间过长，前者是稳定性问题，后者是性能方向的问题")]),t._v(" "),a("p",[a("strong",[t._v("可能导致白屏异常的原因")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("CDN")]),t._v(" "),a("ul",[a("li",[t._v("比如把依赖的框架不随着项目打包而是使用CDN引入，当CDN链接失效时导致导入文件不存在")]),t._v(" "),a("li",[t._v("解决方式：将CDN文件上传到自己的服务器，在服务器建立CDN目录")])])]),t._v(" "),a("li",[a("strong",[t._v("缓存")]),t._v(" "),a("ul",[a("li",[t._v("当项目发版后，客户端可能缓存了上一个版本的文件，所以导致失效")]),t._v(" "),a("li",[t._v("解决方式：可以给css和js文件打包时增加版本号例如当前时间戳"),a("code",[t._v("new Date().getTime()")]),t._v("，使浏览器缓存失效")])])]),t._v(" "),a("li",[a("strong",[t._v("js加载失败造成的渲染异常")]),t._v(" "),a("ul",[a("li",[t._v("打包时文件路径错误或者是服务器中不存在该资源，而页面的渲染又依赖这些js文件的话就会造成渲染异常")])])]),t._v(" "),a("li",[a("strong",[t._v("js代码不兼容")]),t._v(" "),a("ul",[a("li",[t._v("来自第三方库，以"),a("code",[t._v("vue-cli")]),t._v("举例来说，默认只对开发中的代码转换成es5，"),a("code",[t._v("useBuiltIns:'usage'")]),t._v("只根据源代码中出现的语言特性按需引入"),a("code",[t._v("polyfill")]),t._v("，当第三方库使用了es6+代码同时需要引入"),a("code",[t._v("polyfill")]),t._v("时"),a("code",[t._v("vue-cli")]),t._v("是检测不到的，所以会造成js代码不兼容，常见于低版本ios系统；或者第三方库使用了"),a("code",[t._v("commonJs")]),t._v("，而babel是默认处理es6的module类型的，这时候也会导致转换失败")]),t._v(" "),a("li",[t._v("解决方式：在babel配置文件的"),a("code",[t._v("overrides")]),t._v("数组中，对指定的第三方库的指定明确的类型处理"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    overrides"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            include"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第三方库路径")]),t._v("\n            sourceType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'unambiguous'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 明确的转换类型")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("strong",[t._v("js代码错误")])])]),t._v(" "),a("p",[a("strong",[t._v("监控方式")]),t._v("\n以vue为技术栈的项目，可以在"),a("code",[t._v("window.onload")]),t._v("中监听关键dom节点"),a("code",[t._v("#app")]),t._v("有没有被挂载，如果被挂载了设置一个定时器2s后去判断节点中有没有内容")]),t._v(" "),a("p",[a("strong",[t._v("可能导致白屏时间过长的原因")])]),t._v(" "),a("ul",[a("li",[t._v("DNS查询")]),t._v(" "),a("li",[t._v("tcp连接")]),t._v(" "),a("li",[t._v("请求资源文件的下载（html、css、js）")])]),t._v(" "),a("p",[a("strong",[t._v("监控方式")]),t._v("\n在"),a("code",[t._v("window.onload")]),t._v("函数中，封装一个方法获取"),a("code",[t._v("window.performance.timing")]),t._v("，该对象就非常详细的记录了浏览器各个时间节点")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPerformance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("timing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        DnsTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        tcpTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 白屏时间")]),t._v("\n        whiteScreenTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domLoading "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchStart\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有效内容绘制时间")]),t._v("\n        firstScreenTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domContentLoadedEventEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchStart\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);